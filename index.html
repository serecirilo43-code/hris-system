<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login Form</title>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: #f3f4f6;
}

.login-card {
    background: white;
    padding: 30px;
    width: 95%;
    max-width: 380px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}

h2 { text-align: center; }

input {
    width: 100%;
    padding: 12px;
    margin: 10px 0;
    border-radius: 6px;
    border: 1px solid #ccc;
}

button {
    width: 100%;
    padding: 12px;
    background: #6366f1;
    border: none;
    color: white;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
}

button:hover { background: #4f46e5; }

button:disabled {
    background: #9ca3af;
    cursor: not-allowed;
}

@media (max-width: 480px) {
    .login-card { padding: 20px; }
}
</style>
</head>
<body>

<div class="login-card">
    <h2>Login</h2>

    <form id="loginForm">
        <input type="text" id="username" placeholder="Username" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit" id="loginBtn">Login</button>
    </form>
</div>

<script>
const correctUser = "admin";
const correctPass = "password123";

const maxAttempts = 3;
const lockDuration = 20; // seconds

let attempts = parseInt(localStorage.getItem("attempts")) || 0;
let lockTime = parseInt(localStorage.getItem("lockTime")) || 0;

const form = document.getElementById("loginForm");
const loginBtn = document.getElementById("loginBtn");

function checkLock() {
    if (lockTime > 0) {
        const elapsed = Math.floor(Date.now() / 1000) - lockTime;

        if (elapsed < lockDuration) {
            const remaining = lockDuration - elapsed;
            lockAccount(remaining);
            return true;
        } else {
            localStorage.removeItem("attempts");
            localStorage.removeItem("lockTime");
            attempts = 0;
            lockTime = 0;
        }
    }
    return false;
}

function lockAccount(remainingTime) {
    document.getElementById("username").disabled = true;
    document.getElementById("password").disabled = true;
    loginBtn.disabled = true;

    let timerInterval;
    Swal.fire({
        icon: 'warning',
        title: 'Account Locked',
        html: 'Try again in <b></b> seconds.',
        timer: remainingTime * 1000,
        timerProgressBar: true,
        didOpen: () => {
            const b = Swal.getHtmlContainer().querySelector('b');
            timerInterval = setInterval(() => {
                b.textContent = Math.ceil(Swal.getTimerLeft() / 1000);
            }, 100);
        },
        willClose: () => {
            clearInterval(timerInterval);
            localStorage.removeItem("attempts");
            localStorage.removeItem("lockTime");
            location.reload();
        }
    });
}

form.addEventListener("submit", function(e) {
    e.preventDefault();

    if (checkLock()) return;

    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;

    if (username === correctUser && password === correctPass) {

        localStorage.removeItem("attempts");
        localStorage.removeItem("lockTime");

        Swal.fire({
            icon: 'success',
            title: 'Login Successful',
            text: 'Welcome!',
            timer: 1500,
            showConfirmButton: false
        }).then(() => {
            window.location.href = "taskproject.html";
        });

    } else {

        attempts++;
        localStorage.setItem("attempts", attempts);

        if (attempts >= maxAttempts) {
            lockTime = Math.floor(Date.now() / 1000);
            localStorage.setItem("lockTime", lockTime);
            lockAccount(lockDuration);
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Login Failed',
                text: 'Invalid username or password!'
            });
        }
    }
});

checkLock();
</script>

</body>
</html>
